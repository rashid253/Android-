<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Details - NextGen E-commerce</title>
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      /* Global Styling */
      body {
        font-family: 'Roboto', sans-serif;
        background-color: #f3f4f6;
        color: #2d3748;
        margin: 0;
        padding: 0;
      }
      a {
        text-decoration: none;
        color: inherit;
      }
      /* Product Details Section */
      .product-details {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 20px;
      }
      .product-image {
        flex: 1 1 300px;
      }
      .product-image img {
        width: 100%;
        border-radius: 8px;
      }
      .product-info {
        flex: 1 1 300px;
      }
      .product-info h2 {
        font-size: 2rem;
        margin-bottom: 10px;
      }
      .product-info p.price {
        font-size: 1.5rem;
        color: #e4393c;
        margin-bottom: 15px;
      }
      .star-rating i {
        font-size: 1.2rem;
        color: #FFC107;
        margin-right: 2px;
      }
      .add-to-cart-btn {
        margin-top: 15px;
      }
      /* Horizontal Tab Bar */
      .tab-bar {
        margin-top: 30px;
        border-bottom: 1px solid #e0e0e0;
      }
      .tab-bar .nav-link {
        font-size: 1rem;
        padding: 15px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex: 1;
      }
      .tab-bar .nav-link i {
        margin-right: 8px;
      }
      .tab-bar .nav-link.active {
        border-bottom: 3px solid #007bff;
        color: #007bff;
      }
      /* Tab Content Area */
      .tab-content {
        padding: 20px 0;
      }
      /* Description Tab */
      .description-content {
        position: relative;
        max-height: 150px;
        overflow: hidden;
      }
      .description-overlay {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 50px;
        background: linear-gradient(transparent, #f3f4f6);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .read-more-desc {
        background-color: #007bff;
        color: #fff;
        padding: 5px 10px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 0.9rem;
      }
      /* Reviews Section */
      .reviews-container {
        max-height: 250px;
        overflow: hidden;
        position: relative;
        padding-right: 10px;
      }
      .review-item {
        margin-bottom: 20px;
        border-bottom: 1px solid #e0e0e0;
        padding-bottom: 10px;
      }
      .review-item .full-review {
        display: none;
        margin-top: 5px;
      }
      .review-read-more {
        color: #007bff;
        cursor: pointer;
        font-size: 0.9rem;
      }
      .view-more-reviews {
        margin-top: 10px;
      }
      /* Write a Review Section */
      .write-review textarea {
        resize: vertical;
      }
      .star-icon {
        cursor: pointer;
        font-size: 1.2rem;
        color: #ccc;
      }
      .star-icon.selected {
        color: #FFC107;
      }
      /* Related Items Section */
      .related-items {
        display: flex;
        overflow-x: auto;
        gap: 15px;
        padding-bottom: 10px;
      }
      .related-items::-webkit-scrollbar {
        display: none;
      }
      .related-item {
        flex: 0 0 auto;
        width: 140px;
        text-align: center;
      }
      .related-item img {
        width: 100%;
        height: 100px;
        object-fit: cover;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <!-- External Header -->
    <div id="header-placeholder"></div>

    <main class="container">
      <!-- Product Details Section -->
      <div class="product-details">
        <div class="product-image">
          <img
            id="productImage"
            src="https://via.placeholder.com/400x300?text=Product+Image"
            alt="Product Image"
          />
        </div>
        <div class="product-info">
          <h2 id="productName">Product Name</h2>
          <p class="price" id="productPrice">PKR 0</p>
          <div id="productRating" class="star-rating"></div>
          <p id="productStats" class="text-muted">0 Added | 0 Sold</p>
          <button class="btn btn-primary add-to-cart-btn">
            <i class="fa fa-shopping-cart"></i> Add to Cart
          </button>
        </div>
      </div>

      <!-- Horizontal Tab Bar -->
      <ul class="nav nav-tabs tab-bar" id="detailsTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="desc-tab"
            data-bs-toggle="tab"
            data-bs-target="#desc"
            type="button"
            role="tab"
            aria-controls="desc"
            aria-selected="true"
          >
            <i class="fa fa-file-text"></i> Description
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="reviews-tab"
            data-bs-toggle="tab"
            data-bs-target="#reviews"
            type="button"
            role="tab"
            aria-controls="reviews"
            aria-selected="false"
          >
            <i class="fa fa-comments"></i> Reviews
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="related-tab"
            data-bs-toggle="tab"
            data-bs-target="#related"
            type="button"
            role="tab"
            aria-controls="related"
            aria-selected="false"
          >
            <i class="fa fa-th"></i> Related Items
          </button>
        </li>
      </ul>

      <!-- Tab Content -->
      <div class="tab-content" id="detailsTabContent">
        <!-- Description Tab Content -->
        <div
          class="tab-pane fade show active"
          id="desc"
          role="tabpanel"
          aria-labelledby="desc-tab"
        >
          <div class="mt-3">
            <div class="description-content" id="descriptionContent">
              <p id="productDescription">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vel
                mauris quam. Praesent sed nisi eleifend, varius nulla eu, auctor urna.
                Vestibulum ante ipsum primis in faucibus orci luctus et ultrices
                posuere cubilia curae; Suspendisse potenti. Proin ut tincidunt mauris,
                vel dapibus nulla. Nulla facilisi.
              </p>
              <div class="description-overlay" id="descOverlay">
                <span class="read-more-desc" id="readMoreDesc">...Read More</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Reviews Tab Content -->
        <div
          class="tab-pane fade"
          id="reviews"
          role="tabpanel"
          aria-labelledby="reviews-tab"
        >
          <div class="mt-3">
            <!-- Reviews List -->
            <div class="reviews-container" id="reviewsContainer">
              <div class="review-item">
                <p>
                  <strong>User1:</strong> Amazing quality, highly recommended!
                  <span class="review-read-more">...Read more</span>
                </p>
                <p><small>Reviewed on July 10, 2025</small></p>
                <p class="full-review">
                  Full review text for User1. Lorem ipsum dolor sit amet, consectetur
                  adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore
                  magna aliqua.
                </p>
              </div>
              <div class="review-item">
                <p>
                  <strong>User2:</strong> Good value for money.
                  <span class="review-read-more">...Read more</span>
                </p>
                <p><small>Reviewed on July 8, 2025</small></p>
                <p class="full-review">
                  Full review text for User2. Additional details about the product
                  experience go here.
                </p>
              </div>
            </div>
            <button id="viewMoreReviews" class="btn btn-link view-more-reviews">
              View More Reviews
            </button>
            <!-- Write a Review Section -->
            <div class="write-review mt-4">
              <h6>Write a Review</h6>
              <div id="ratingStars" class="mb-2">
                <i class="fa fa-star star-icon" data-value="1"></i>
                <i class="fa fa-star star-icon" data-value="2"></i>
                <i class="fa fa-star star-icon" data-value="3"></i>
                <i class="fa fa-star star-icon" data-value="4"></i>
                <i class="fa fa-star star-icon" data-value="5"></i>
              </div>
              <textarea
                class="form-control"
                rows="3"
                placeholder="Share your experience after purchasing"
              ></textarea>
              <button class="btn btn-success mt-2">Submit Review</button>
            </div>
          </div>
        </div>

        <!-- Related Items Tab Content -->
        <div
          class="tab-pane fade"
          id="related"
          role="tabpanel"
          aria-labelledby="related-tab"
        >
          <div class="mt-3">
            <h5>Recommended For You</h5>
            <div class="related-items" id="relatedItemsContainer">
              <!-- Dummy related items; in future, AI recommendations will be integrated -->
              <div class="related-item">
                <img
                  src="https://via.placeholder.com/140x100?text=Item+1"
                  alt="Item 1"
                />
                <p class="small">Item 1</p>
              </div>
              <div class="related-item">
                <img
                  src="https://via.placeholder.com/140x100?text=Item+2"
                  alt="Item 2"
                />
                <p class="small">Item 2</p>
              </div>
              <div class="related-item">
                <img
                  src="https://via.placeholder.com/140x100?text=Item+3"
                  alt="Item 3"
                />
                <p class="small">Item 3</p>
              </div>
              <div class="related-item">
                <img
                  src="https://via.placeholder.com/140x100?text=Item+4"
                  alt="Item 4"
                />
                <p class="small">Item 4</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Extra Engaging Feature: Simulated AI Recommendation Banner -->
      <div class="mt-4">
        <div class="alert alert-info text-center">
          AI Recommendation: Check out the trending products based on your preferences!
        </div>
      </div>
    </main>

    <!-- External Footer -->
    <div id="footer-placeholder"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Load external header and footer (dummy files, to be replaced with your actual header.html and footer.html)
      function loadHTML(elementId, filePath) {
        fetch(filePath)
          .then(response => (response.ok ? response.text() : Promise.reject("Error loading " + filePath)))
          .then(html => {
            document.getElementById(elementId).innerHTML = html;
          })
          .catch(error => console.error(error));
      }
      document.addEventListener("DOMContentLoaded", function () {
        loadHTML("header-placeholder", "header.html");
        loadHTML("footer-placeholder", "footer.html");
      });

      // Dummy product data (to be replaced by Firebase Firestore calls in the future)
      const product = JSON.parse(localStorage.getItem("selectedProduct")) || {
        name: "Default Product",
        price: "PKR 0",
        description: "No description available.",
        image: "https://via.placeholder.com/400x300?text=Product+Image",
        rating: 0,
        added: "0",
        sold: "0"
      };

      // Populate product details
      document.getElementById("productName").innerText = product.name;
      document.getElementById("productPrice").innerText = product.price;
      document.getElementById("productDescription").innerText = product.description;
      document.getElementById("productImage").src = product.image;
      document.getElementById("productRating").innerHTML = generateStars(product.rating);
      document.getElementById("productStats").innerText =
        product.added + " Added | " + product.sold + " Sold";

      // Helper function to generate star rating HTML
      function generateStars(rating) {
        let html = "";
        const fullStars = Math.floor(rating);
        const halfStar = rating - fullStars >= 0.5 ? 1 : 0;
        for (let i = 0; i < fullStars; i++) {
          html += '<i class="fa fa-star"></i>';
        }
        if (halfStar) {
          html += '<i class="fa fa-star-half-alt"></i>';
        }
        return html;
      }

      // Description "Read More" toggle functionality
      document.getElementById("readMoreDesc").addEventListener("click", function () {
        const descContent = document.getElementById("descriptionContent");
        if (descContent.style.maxHeight === "none") {
          descContent.style.maxHeight = "150px";
          this.textContent = "...Read More";
          document.getElementById("descOverlay").style.display = "flex";
        } else {
          descContent.style.maxHeight = "none";
          this.textContent = "Show Less";
          document.getElementById("descOverlay").style.display = "none";
        }
      });

      // Reviews "Read More" toggle for each review item
      document.addEventListener("click", function (e) {
        if (e.target && e.target.classList.contains("review-read-more")) {
          const fullReview = e.target.parentElement.nextElementSibling;
          if (fullReview && fullReview.classList.contains("full-review")) {
            if (fullReview.style.display === "none" || fullReview.style.display === "") {
              fullReview.style.display = "block";
              e.target.textContent = " Show less";
            } else {
              fullReview.style.display = "none";
              e.target.textContent = "...Read more";
            }
          }
        }
      });

      // "View More Reviews" button functionality
      document.getElementById("viewMoreReviews").addEventListener("click", function () {
        const reviewsContainer = document.getElementById("reviewsContainer");
        if (reviewsContainer.style.maxHeight === "none") {
          reviewsContainer.style.maxHeight = "250px";
          this.textContent = "View More Reviews";
        } else {
          reviewsContainer.style.maxHeight = "none";
          this.textContent = "View Less Reviews";
        }
      });

      // Rating stars functionality in the Write a Review section
      const starIcons = document.querySelectorAll("#ratingStars .star-icon");
      starIcons.forEach((star) => {
        star.addEventListener("click", function () {
          const rating = this.getAttribute("data-value");
          starIcons.forEach((s) => {
            if (s.getAttribute("data-value") <= rating) {
              s.classList.add("selected");
            } else {
              s.classList.remove("selected");
            }
          });
        });
      });
    </script>
  </body>
</html>
