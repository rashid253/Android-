<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product Details - NextGen E-commerce</title>
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- Bootstrap 5 CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <!-- Global Styles -->
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Additional styles for details.html remain unchanged */
    body {
      margin-top: 70px;
      scroll-behavior: smooth;
    }
    /* (Other CSS rules remain as per your original design) */
  </style>
  <script>
    // -------------------------------
    // Modular Cart Manager Class
    // -------------------------------
    class CartManager {
      static getCart() {
        return JSON.parse(localStorage.getItem('cart')) || [];
      }
      static saveCart(cart) {
        localStorage.setItem('cart', JSON.stringify(cart));
      }
      static addProduct(product) {
        let cart = this.getCart();
        const existing = cart.find(item => item.id === product.id);
        if (existing) {
          existing.quantity = (existing.quantity || 1) + 1;
        } else {
          product.quantity = 1;
          cart.push(product);
        }
        this.saveCart(cart);
      }
    }

    // -------------------------------
    // Utility Function to Load External HTML
    // -------------------------------
    function loadHTML(elementId, filePath) {
      return fetch(filePath)
        .then(response => {
          if (!response.ok) throw new Error("Error fetching " + filePath);
          return response.text();
        })
        .then(html => {
          document.getElementById(elementId).innerHTML = html;
        })
        .catch(error => console.error(error));
    }

    // -------------------------------
    // Helper: Generate Star Rating HTML
    // -------------------------------
    function generateStars(rating) {
      let html = "";
      const fullStars = Math.floor(rating);
      const halfStar = rating - fullStars >= 0.5 ? 1 : 0;
      for (let i = 0; i < fullStars; i++) {
        html += '<i class="fa fa-star text-warning"></i>';
      }
      if (halfStar) {
        html += '<i class="fa fa-star-half-alt text-warning"></i>';
      }
      return html;
    }

    // -------------------------------
    // On DOMContentLoaded: Load header/footer and populate product details
    // -------------------------------
    document.addEventListener("DOMContentLoaded", () => {
      // Load external header and footer
      loadHTML("header-placeholder", "header.html");
      loadHTML("footer-placeholder", "footer.html");

      // Retrieve product details from localStorage (set by previous page)
      const product = JSON.parse(localStorage.getItem("selectedProduct")) || {
        id: 0,
        name: "Default Product",
        price: "PKR 0",
        description: "No description available.",
        image: "https://via.placeholder.com/400x300?text=Product+Image",
        rating: 0,
        added: "0",
        sold: "0"
      };

      // Populate product details into the page elements
      document.getElementById("productName").innerText = product.name;
      document.getElementById("productPrice").innerText = product.price;
      document.getElementById("productDescription").innerText = product.description;
      document.getElementById("productImage").src = product.image;
      document.getElementById("productRating").innerHTML = generateStars(product.rating);
      document.getElementById("productStats").innerText =
        product.added + " Added | " + product.sold + " Sold";

      // Setup "Add to Cart" button event
      const addToCartBtn = document.querySelector(".add-to-cart-btn");
      if (addToCartBtn) {
        addToCartBtn.addEventListener("click", () => {
          CartManager.addProduct(product);
          // Optionally, show a success message here
          window.location.href = "cart.html"; // Redirect to cart page
        });
      }
    });
  </script>
</head>
<body>
  <!-- External Header -->
  <div id="header-placeholder"></div>

  <!-- Product Details Section -->
  <div class="container mt-5 mb-5">
    <div class="row">
      <!-- Product Image -->
      <div class="col-md-5 text-center mb-3">
        <img id="productImage" src="https://via.placeholder.com/400x300?text=Product+Image" alt="Product Image" class="img-fluid rounded" />
      </div>
      <!-- Product Information -->
      <div class="col-md-7">
        <h2 id="productName">Product Name</h2>
        <p class="h5 text-primary" id="productPrice">PKR 0</p>
        <div id="productRating" class="star-rating mb-2"></div>
        <p id="productStats" class="text-muted mb-3">0 Added | 0 Sold</p>
        <!-- Add to Cart Button -->
        <button class="btn btn-success add-to-cart-btn mt-3">
          <i class="fa fa-shopping-cart"></i> Add to Cart
        </button>
      </div>
    </div>
  </div>

  <!-- (Other sections such as Description, Reviews, Related Items remain as originally designed) -->
  
  <!-- External Footer -->
  <div id="footer-placeholder"></div>
</body>
</html>
