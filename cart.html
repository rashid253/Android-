<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NextGen Cart - Your Shopping Cart</title>
    <!-- Font Awesome for icons (used in header/footer) -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Custom CSS for overall site (header, footer, etc.) -->
    <link rel="stylesheet" href="style.css" />
    <!-- Bootstrap 5 CSS for layout -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Inline CSS for Cart Page -->
    <style>
      body {
        font-family: 'Roboto', sans-serif;
        background-color: #f3f4f6;
        color: #2d3748;
        margin: 0;
        padding: 0;
      }
      a {
        text-decoration: none;
        color: inherit;
        transition: color 0.3s ease;
      }
      a:hover {
        color: #ff6f61;
      }
      main {
        padding-bottom: 100px;
      }
      .cart-container {
        margin: 40px auto;
        max-width: 1200px;
      }
      .cart-title {
        margin-bottom: 30px;
      }
      .cart-table th,
      .cart-table td {
        vertical-align: middle;
        text-align: center;
      }
      .cart-table img {
        max-width: 80px;
      }
      .quantity-input {
        width: 60px;
        text-align: center;
      }
      .summary-box {
        border: 1px solid #ddd;
        padding: 20px;
        border-radius: 8px;
        background: #fff;
      }
      .summary-box h4 {
        margin-bottom: 20px;
      }
      .summary-box .summary-line {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
      }
      .checkout-btn {
        width: 100%;
        padding: 15px;
        font-size: 1.2rem;
      }
    </style>
  </head>
  <body>
    <!-- Header Placeholder (loaded dynamically from header.html) -->
    <div id="header-placeholder"></div>

    <!-- Main Cart Content -->
    <main>
      <div class="container cart-container">
        <h1 class="cart-title text-center">Your Shopping Cart</h1>
        <!-- Cart Table -->
        <div class="table-responsive">
          <table class="table table-bordered cart-table">
            <thead class="table-light">
              <tr>
                <th>Product</th>
                <th>Name</th>
                <th>Price (PKR)</th>
                <th>Quantity</th>
                <th>Subtotal (PKR)</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="cartItemsContainer">
              <!-- Cart items will be dynamically rendered here -->
            </tbody>
          </table>
        </div>
        <!-- Summary Section -->
        <div class="row">
          <div class="col-md-4 offset-md-8">
            <div class="summary-box">
              <h4>Order Summary</h4>
              <div class="summary-line">
                <span>Subtotal:</span>
                <span id="subtotalDisplay">0</span>
              </div>
              <div class="summary-line">
                <span>Tax (10%):</span>
                <span id="taxDisplay">0</span>
              </div>
              <div class="summary-line">
                <span>Total:</span>
                <span id="totalDisplay">0</span>
              </div>
              <button class="btn btn-success checkout-btn mt-3">Proceed to Checkout</button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer Placeholder (loaded dynamically from footer.html) -->
    <div id="footer-placeholder"></div>

    <!-- Scripts -->
    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Script to load header and footer dynamically -->
    <script>
      function loadHTML(elementId, filePath) {
        fetch(filePath)
          .then(response => {
            if (!response.ok) {
              // Fallback content if file not found
              if (elementId === "header-placeholder") {
                document.getElementById(elementId).innerHTML =
                  '<header style="background:#333;color:#fff;padding:10px;text-align:center;">Header</header>';
              } else if (elementId === "footer-placeholder") {
                document.getElementById(elementId).innerHTML =
                  '<footer style="background:#333;color:#fff;padding:10px;text-align:center;">Footer</footer>';
              }
              throw new Error('Error fetching ' + filePath);
            }
            return response.text();
          })
          .then(html => {
            document.getElementById(elementId).innerHTML = html;
          })
          .catch(error => console.error(error));
      }
      document.addEventListener("DOMContentLoaded", function () {
        loadHTML("header-placeholder", "header.html");
        loadHTML("footer-placeholder", "footer.html");
      });
    </script>
    <!-- Cart Calculation and Rendering Script -->
    <script>
      // Dummy cart data
      let cartItems = [
        {
          id: 1,
          name: "Smartphone A",
          price: 894,
          quantity: 1,
          image: "https://via.placeholder.com/100x100?text=Smartphone+A"
        },
        {
          id: 2,
          name: "Smart TV B",
          price: 557,
          quantity: 2,
          image: "https://via.placeholder.com/100x100?text=Smart+TV+B"
        },
        {
          id: 3,
          name: "Laptop C",
          price: 1004,
          quantity: 1,
          image: "https://via.placeholder.com/100x100?text=Laptop+C"
        }
      ];

      // Function to render cart items in the table
      function renderCartItems() {
        const container = document.getElementById("cartItemsContainer");
        container.innerHTML = "";
        cartItems.forEach((item, index) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td><img src="${item.image}" alt="${item.name}" /></td>
            <td>${item.name}</td>
            <td>${item.price}</td>
            <td>
              <button class="btn btn-sm btn-outline-secondary" onclick="changeQuantity(${index}, -1)">-</button>
              <input type="text" class="quantity-input" value="${item.quantity}" readonly />
              <button class="btn btn-sm btn-outline-secondary" onclick="changeQuantity(${index}, 1)">+</button>
            </td>
            <td id="itemSubtotal-${index}">${item.price * item.quantity}</td>
            <td><button class="btn btn-sm btn-danger" onclick="removeItem(${index})">Remove</button></td>
          `;
          container.appendChild(row);
        });
        updateSummary();
      }

      // Function to update quantity and recalculate subtotal for an item
      function changeQuantity(index, delta) {
        const item = cartItems[index];
        item.quantity = Math.max(1, item.quantity + delta);
        renderCartItems();
      }

      // Function to remove an item from the cart
      function removeItem(index) {
        cartItems.splice(index, 1);
        renderCartItems();
      }

      // Function to update the order summary calculations
      function updateSummary() {
        let subtotal = cartItems.reduce((acc, item) => acc + item.price * item.quantity, 0);
        let tax = subtotal * 0.10; // Assume 10% tax
        let total = subtotal + tax;
        document.getElementById("subtotalDisplay").innerText = subtotal.toFixed(2);
        document.getElementById("taxDisplay").innerText = tax.toFixed(2);
        document.getElementById("totalDisplay").innerText = total.toFixed(2);
      }

      // Initialize the cart rendering on page load
      window.onload = function () {
        renderCartItems();
      };
    </script>
    <!--
      This frontend code is built using dummy data and is structured to be easily integrated with a Firebase backend in the future.
      The fetchProducts() function currently simulates data fetching, and will later be replaced by Firebase Firestore API calls.
      Authentication and data persistence will be handled via Firebase, allowing for dynamic and secure data management.
    -->
  </body>
</html>
