<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MyBusiness Cart</title>
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css" />
    <style>
      /* Additional styles specific for the Cart page */
      .cart-container {
        padding: 20px;
        background: #f4f4f4;
        min-height: calc(100vh - 140px);
      }
      .cart-container h1 {
        margin-bottom: 20px;
        font-size: 2rem;
        color: #007bff;
      }
      .cart-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 15px;
        background: #fff;
        border-radius: 8px;
        margin-bottom: 15px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .cart-item img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 4px;
        margin-right: 15px;
      }
      .cart-item-details {
        flex: 1;
      }
      .cart-item-details h3 {
        font-size: 1.2rem;
        margin-bottom: 8px;
        color: #333;
      }
      .cart-item-details p {
        color: #666;
        margin: 0;
      }
      .cart-item-actions {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }
      .cart-item-actions button {
        background: none;
        border: none;
        cursor: pointer;
        color: #007bff;
        font-size: 1.2rem;
      }
      .cart-total {
        text-align: right;
        font-size: 1.3rem;
        font-weight: bold;
        margin-top: 20px;
      }
      .checkout-button {
        background: #28a745;
        border: none;
        color: #fff;
        padding: 12px 25px;
        font-size: 1rem;
        border-radius: 25px;
        cursor: pointer;
        margin-top: 20px;
        float: right;
        transition: background-color 0.3s;
      }
      .checkout-button:hover {
        background: #218838;
      }
      .empty-cart {
        text-align: center;
        font-size: 1.2rem;
        margin-top: 50px;
        color: #666;
      }
    </style>
  </head>
  <body>
    <!-- External Header -->
    <div id="header-placeholder"></div>

    <!-- Main Cart Content -->
    <main class="cart-container">
      <h1>Your Shopping Cart</h1>
      <div id="cart-items">
        <!-- Dynamic cart items will be rendered here -->
      </div>
      <div class="cart-total" id="cart-total">Total: $0.00</div>
      <button class="checkout-button" id="checkout-button">
        Proceed to Checkout
      </button>
    </main>

    <!-- External Footer -->
    <div id="footer-placeholder"></div>

    <!-- JavaScript for cart functionality -->
    <script>
      /* 
        This frontend code is built using dummy data and is structured to be easily integrated with a Firebase backend in the future.
        The fetchCartItems() function currently simulates data fetching, and will later be replaced by Firebase Firestore API calls.
        Authentication and data persistence will be handled via Firebase, allowing for dynamic and secure data management.
      */

      // Simulated fetch function for cart items (dummy data)
      const fetchCartItems = () => [
        {
          id: 1,
          name: "Product 1",
          price: 29.99,
          quantity: 1,
          image: "https://via.placeholder.com/80"
        },
        {
          id: 2,
          name: "Product 2",
          price: 49.99,
          quantity: 2,
          image: "https://via.placeholder.com/80"
        },
        {
          id: 3,
          name: "Product 3",
          price: 19.99,
          quantity: 1,
          image: "https://via.placeholder.com/80"
        }
      ];

      // Render the cart items and update the total
      const renderCart = () => {
        const cartItemsContainer = document.getElementById("cart-items");
        const cartTotalContainer = document.getElementById("cart-total");
        const cartItems = fetchCartItems();

        if (!cartItems.length) {
          cartItemsContainer.innerHTML =
            '<p class="empty-cart">Your cart is empty.</p>';
          cartTotalContainer.innerText = "Total: $0.00";
          return;
        }

        let total = 0;
        cartItemsContainer.innerHTML = "";
        cartItems.forEach((item) => {
          total += item.price * item.quantity;
          const itemEl = document.createElement("div");
          itemEl.className = "cart-item";
          itemEl.innerHTML = `
            <img src="${item.image}" alt="${item.name}" />
            <div class="cart-item-details">
              <h3>${item.name}</h3>
              <p>$${item.price.toFixed(2)} x ${item.quantity}</p>
            </div>
            <div class="cart-item-actions">
              <button onclick="removeItem(${item.id})" title="Remove">
                <i class="fas fa-trash-alt"></i>
              </button>
              <button onclick="updateQuantity(${item.id}, ${item.quantity + 1})" title="Increase Quantity">
                <i class="fas fa-plus"></i>
              </button>
              <button onclick="updateQuantity(${item.id}, ${item.quantity - 1})" title="Decrease Quantity">
                <i class="fas fa-minus"></i>
              </button>
            </div>
          `;
          cartItemsContainer.appendChild(itemEl);
        });
        cartTotalContainer.innerText = "Total: $" + total.toFixed(2);
      };

      // Dummy function for removing an item from the cart
      function removeItem(itemId) {
        alert("Remove item with id: " + itemId);
        // Future implementation: Remove item from Firebase and update the UI
      }

      // Dummy function for updating item quantity
      function updateQuantity(itemId, newQuantity) {
        if (newQuantity < 1) {
          alert("Quantity cannot be less than 1.");
          return;
        }
        alert("Update item " + itemId + " to quantity " + newQuantity);
        // Future implementation: Update quantity in Firebase and re-render cart
      }

      // Function to load external HTML (for header and footer)
      const loadHTML = (elementId, filePath) => {
        fetch(filePath)
          .then((response) => {
            if (!response.ok) {
              throw new Error("Error fetching " + filePath);
            }
            return response.text();
          })
          .then((html) => {
            document.getElementById(elementId).innerHTML = html;
          })
          .catch((error) => console.error(error));
      };

      // Initialize the cart and load external components on page load
      document.addEventListener("DOMContentLoaded", () => {
        renderCart();
        loadHTML("header-placeholder", "header.html");
        loadHTML("footer-placeholder", "footer.html");
      });
    </script>
  </body>
</html>
