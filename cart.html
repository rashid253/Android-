<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MyBusiness Cart - International Standard</title>
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css" />
    <!-- Inline CSS for Cart Page -->
    <style>
      body {
        font-family: 'Roboto', sans-serif;
        background-color: #f8f9fa;
        color: #333;
      }
      main {
        margin-top: 80px;  /* Space for fixed header */
        margin-bottom: 80px; /* Space for fixed footer */
      }
      .cart-container {
        padding: 40px 0;
      }
      .cart-title {
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 30px;
        color: #007bff;
        text-align: center;
      }
      .table-responsive {
        margin-bottom: 30px;
      }
      .cart-table th,
      .cart-table td {
        vertical-align: middle;
        text-align: center;
        font-size: 1rem;
      }
      .cart-table img {
        max-width: 80px;
        border-radius: 5px;
      }
      .quantity-input {
        width: 60px;
        text-align: center;
        border: 1px solid #ced4da;
        border-radius: 5px;
        padding: 5px;
      }
      .order-summary {
        background: #fff;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }
      .order-summary h4 {
        font-size: 1.75rem;
        font-weight: bold;
        margin-bottom: 20px;
        color: #007bff;
      }
      .summary-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        font-size: 1rem;
      }
      .summary-total {
        font-size: 1.25rem;
        font-weight: bold;
      }
      .coupon-code {
        margin-top: 20px;
      }
      .coupon-code input {
        border-radius: 5px;
        padding: 8px;
        border: 1px solid #ced4da;
        width: 100%;
      }
      .apply-coupon {
        margin-top: 10px;
      }
      .checkout-btn {
        width: 100%;
        padding: 15px;
        font-size: 1.2rem;
        margin-top: 20px;
      }
      /* Button hover effect */
      .btn-outline-secondary:hover {
        background-color: #f0f0f0;
      }
    </style>
  </head>
  <body>
    <!-- Header Placeholder (loaded dynamically from header.html) -->
    <div id="header-placeholder"></div>
    
    <!-- Main Cart Content -->
    <main>
      <div class="container cart-container">
        <h1 class="cart-title">Your Shopping Cart</h1>
        <div class="row">
          <!-- Left Column: Cart Items -->
          <div class="col-lg-8">
            <div class="table-responsive">
              <table class="table table-bordered cart-table">
                <thead class="table-light">
                  <tr>
                    <th>Product</th>
                    <th>Name</th>
                    <th>Price (PKR)</th>
                    <th>Quantity</th>
                    <th>Subtotal (PKR)</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="cartItemsContainer">
                  <!-- Cart items will be rendered dynamically -->
                </tbody>
              </table>
            </div>
          </div>
          <!-- Right Column: Order Summary -->
          <div class="col-lg-4">
            <div class="order-summary">
              <h4>Order Summary</h4>
              <div class="summary-item">
                <span>Subtotal:</span>
                <span id="subtotalDisplay">0.00</span>
              </div>
              <div class="summary-item">
                <span>Tax (10%):</span>
                <span id="taxDisplay">0.00</span>
              </div>
              <div class="summary-item">
                <span>Shipping:</span>
                <span id="shippingDisplay">0.00</span>
              </div>
              <div class="summary-item summary-total">
                <span>Total:</span>
                <span id="totalDisplay">0.00</span>
              </div>
              <div class="coupon-code">
                <input type="text" id="couponInput" placeholder="Enter Coupon Code">
                <button class="btn btn-outline-primary apply-coupon" onclick="applyCoupon()">Apply Coupon</button>
              </div>
              <button class="btn btn-success checkout-btn" onclick="proceedToCheckout()">Proceed to Checkout</button>
            </div>
          </div>
        </div>
      </div>
    </main>
    
    <!-- Footer Placeholder (loaded dynamically from footer.html) -->
    <div id="footer-placeholder"></div>
    
    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Script to Load Header and Footer Dynamically -->
    <script>
      function loadHTML(elementId, filePath) {
        fetch(filePath)
          .then(response => {
            if (!response.ok) {
              if (elementId === "header-placeholder") {
                document.getElementById(elementId).innerHTML = '<header style="background:#333;color:#fff;padding:10px;text-align:center;">Header</header>';
              } else if (elementId === "footer-placeholder") {
                document.getElementById(elementId).innerHTML = '<footer style="background:#333;color:#fff;padding:10px;text-align:center;">Footer</footer>';
              }
              throw new Error("Error fetching " + filePath);
            }
            return response.text();
          })
          .then(html => {
            document.getElementById(elementId).innerHTML = html;
          })
          .catch(error => console.error(error));
      }
      
      document.addEventListener("DOMContentLoaded", function() {
        loadHTML("header-placeholder", "header.html");
        loadHTML("footer-placeholder", "footer.html");
      });
    </script>
    
    <!-- Cart Functionality Script -->
    <script>
      // Dummy cart data â€“ in a real system this would come from a database
      let cartItems = [
        {
          id: 1,
          name: "Smartphone A",
          price: 894,
          quantity: 1,
          image: "https://via.placeholder.com/100?text=Smartphone+A"
        },
        {
          id: 2,
          name: "Smart TV B",
          price: 557,
          quantity: 2,
          image: "https://via.placeholder.com/100?text=Smart+TV+B"
        },
        {
          id: 3,
          name: "Laptop C",
          price: 1004,
          quantity: 1,
          image: "https://via.placeholder.com/100?text=Laptop+C"
        }
      ];
      
      let couponDiscount = 0; // 0 means no discount, 0.1 means 10%, etc.
      let shippingCost = 150; // Fixed shipping cost
      
      function renderCartItems() {
        const container = document.getElementById("cartItemsContainer");
        container.innerHTML = "";
        cartItems.forEach((item, index) => {
          const itemSubtotal = item.price * item.quantity;
          const row = document.createElement("tr");
          row.innerHTML = `
            <td><img src="${item.image}" alt="${item.name}"></td>
            <td>${item.name}</td>
            <td>${item.price}</td>
            <td>
              <button class="btn btn-sm btn-outline-secondary" onclick="changeQuantity(${index}, -1)">-</button>
              <input type="text" class="quantity-input" value="${item.quantity}" readonly>
              <button class="btn btn-sm btn-outline-secondary" onclick="changeQuantity(${index}, 1)">+</button>
            </td>
            <td id="itemSubtotal-${index}">${itemSubtotal.toFixed(2)}</td>
            <td><button class="btn btn-sm btn-danger" onclick="removeItem(${index})">Remove</button></td>
          `;
          container.appendChild(row);
        });
        updateSummary();
      }
      
      function changeQuantity(index, delta) {
        const item = cartItems[index];
        item.quantity = Math.max(1, item.quantity + delta);
        renderCartItems();
      }
      
      function removeItem(index) {
        cartItems.splice(index, 1);
        renderCartItems();
      }
      
      function updateSummary() {
        let subtotal = cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0);
        let tax = subtotal * 0.10; // 10% tax
        let discount = subtotal * couponDiscount;
        let total = subtotal + tax + shippingCost - discount;
        
        document.getElementById("subtotalDisplay").innerText = subtotal.toFixed(2);
        document.getElementById("taxDisplay").innerText = tax.toFixed(2);
        document.getElementById("shippingDisplay").innerText = shippingCost.toFixed(2);
        document.getElementById("totalDisplay").innerText = total.toFixed(2);
      }
      
      function applyCoupon() {
        const couponCode = document.getElementById("couponInput").value.trim().toUpperCase();
        if (couponCode === "SAVE10") {
          couponDiscount = 0.10;
          alert("Coupon applied: 10% discount!");
        } else if (couponCode === "SAVE20") {
          couponDiscount = 0.20;
          alert("Coupon applied: 20% discount!");
        } else {
          couponDiscount = 0;
          alert("Invalid coupon code.");
        }
        updateSummary();
      }
      
      function proceedToCheckout() {
        alert("Proceeding to checkout...");
      }
      
      document.addEventListener("DOMContentLoaded", function() {
        renderCartItems();
      });
    </script>
    
    <!--
      This frontend code is built using dummy data and is structured to be easily integrated with a Firebase backend in the future.
      The fetchProducts() function currently simulates data fetching, and will later be replaced by Firebase Firestore API calls.
      Authentication and data persistence will be handled via Firebase, allowing for dynamic and secure data management.
    -->
  </body>
</html>
